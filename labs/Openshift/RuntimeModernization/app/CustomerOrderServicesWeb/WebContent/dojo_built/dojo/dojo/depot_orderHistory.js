/*
	Copyright (c) 2004-2010, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["dojox.string.Builder"]){dojo._hasResource["dojox.string.Builder"]=true;dojo.provide("dojox.string.Builder");dojox.string.Builder=function(_1){var b="";this.length=0;this.append=function(s){if(arguments.length>1){var _2="",l=arguments.length;switch(l){case 9:_2=""+arguments[8]+_2;case 8:_2=""+arguments[7]+_2;case 7:_2=""+arguments[6]+_2;case 6:_2=""+arguments[5]+_2;case 5:_2=""+arguments[4]+_2;case 4:_2=""+arguments[3]+_2;case 3:_2=""+arguments[2]+_2;case 2:b+=""+arguments[0]+arguments[1]+_2;break;default:var i=0;while(i<arguments.length){_2+=arguments[i++];}b+=_2;}}else{b+=s;}this.length=b.length;return this;};this.concat=function(s){return this.append.apply(this,arguments);};this.appendArray=function(_3){return this.append.apply(this,_3);};this.clear=function(){b="";this.length=0;return this;};this.replace=function(_4,_5){b=b.replace(_4,_5);this.length=b.length;return this;};this.remove=function(_6,_7){if(_7===undefined){_7=b.length;}if(_7==0){return this;}b=b.substr(0,_6)+b.substr(_6+_7);this.length=b.length;return this;};this.insert=function(_8,_9){if(_8==0){b=_9+b;}else{b=b.slice(0,_8)+_9+b.slice(_8);}this.length=b.length;return this;};this.toString=function(){return b;};if(_1){this.append(_1);}};}if(!dojo._hasResource["dojox.string.tokenize"]){dojo._hasResource["dojox.string.tokenize"]=true;dojo.provide("dojox.string.tokenize");dojox.string.tokenize=function(_a,re,_b,_c){var _d=[];var _e,_f,_10=0;while(_e=re.exec(_a)){_f=_a.slice(_10,re.lastIndex-_e[0].length);if(_f.length){_d.push(_f);}if(_b){if(dojo.isOpera){var _11=_e.slice(0);while(_11.length<_e.length){_11.push(null);}_e=_11;}var _12=_b.apply(_c,_e.slice(1).concat(_d.length));if(typeof _12!="undefined"){_d.push(_12);}}_10=re.lastIndex;}_f=_a.slice(_10);if(_f.length){_d.push(_f);}return _d;};}if(!dojo._hasResource["dojox.dtl._base"]){dojo._hasResource["dojox.dtl._base"]=true;dojo.provide("dojox.dtl._base");dojo.experimental("dojox.dtl");(function(){var dd=dojox.dtl;dd.TOKEN_BLOCK=-1;dd.TOKEN_VAR=-2;dd.TOKEN_COMMENT=-3;dd.TOKEN_TEXT=3;dd._Context=dojo.extend(function(_13){if(_13){dojo._mixin(this,_13);if(_13.get){this._getter=_13.get;delete this.get;}}},{push:function(){var _14=this;var _15=dojo.delegate(this);_15.pop=function(){return _14;};return _15;},pop:function(){throw new Error("pop() called on empty Context");},get:function(key,_16){var n=this._normalize;if(this._getter){var got=this._getter(key);if(typeof got!="undefined"){return n(got);}}if(typeof this[key]!="undefined"){return n(this[key]);}return _16;},_normalize:function(_17){if(_17 instanceof Date){_17.year=_17.getFullYear();_17.month=_17.getMonth()+1;_17.day=_17.getDate();_17.date=_17.year+"-"+("0"+_17.month).slice(-2)+"-"+("0"+_17.day).slice(-2);_17.hour=_17.getHours();_17.minute=_17.getMinutes();_17.second=_17.getSeconds();_17.microsecond=_17.getMilliseconds();}return _17;},update:function(_18){var _19=this.push();if(_18){dojo._mixin(this,_18);}return _19;}});var _1a=/("(?:[^"\\]*(?:\\.[^"\\]*)*)"|'(?:[^'\\]*(?:\\.[^'\\]*)*)'|[^\s]+)/g;var _1b=/\s+/g;var _1c=function(_1d,_1e){_1d=_1d||_1b;if(!(_1d instanceof RegExp)){_1d=new RegExp(_1d,"g");}if(!_1d.global){throw new Error("You must use a globally flagged RegExp with split "+_1d);}_1d.exec("");var _1f,_20=[],_21=0,i=0;while(_1f=_1d.exec(this)){_20.push(this.slice(_21,_1d.lastIndex-_1f[0].length));_21=_1d.lastIndex;if(_1e&&(++i>_1e-1)){break;}}_20.push(this.slice(_21));return _20;};dd.Token=function(_22,_23){this.token_type=_22;this.contents=new String(dojo.trim(_23));this.contents.split=_1c;this.split=function(){return String.prototype.split.apply(this.contents,arguments);};};dd.Token.prototype.split_contents=function(_24){var bit,_25=[],i=0;_24=_24||999;while(i++<_24&&(bit=_1a.exec(this.contents))){bit=bit[0];if(bit.charAt(0)=="\""&&bit.slice(-1)=="\""){_25.push("\""+bit.slice(1,-1).replace("\\\"","\"").replace("\\\\","\\")+"\"");}else{if(bit.charAt(0)=="'"&&bit.slice(-1)=="'"){_25.push("'"+bit.slice(1,-1).replace("\\'","'").replace("\\\\","\\")+"'");}else{_25.push(bit);}}}return _25;};var ddt=dd.text={_get:function(_26,_27,_28){var _29=dd.register.get(_26,_27.toLowerCase(),_28);if(!_29){if(!_28){throw new Error("No tag found for "+_27);}return null;}var fn=_29[1];var _2a=_29[2];var _2b;if(fn.indexOf(":")!=-1){_2b=fn.split(":");fn=_2b.pop();}dojo["require"](_2a);var _2c=dojo.getObject(_2a);return _2c[fn||_27]||_2c[_27+"_"]||_2c[fn+"_"];},getTag:function(_2d,_2e){return ddt._get("tag",_2d,_2e);},getFilter:function(_2f,_30){return ddt._get("filter",_2f,_30);},getTemplate:function(_31){return new dd.Template(ddt.getTemplateString(_31));},getTemplateString:function(_32){return dojo._getText(_32.toString())||"";},_resolveLazy:function(_33,_34,_35){if(_34){if(_35){return dojo.fromJson(dojo._getText(_33))||{};}else{return dd.text.getTemplateString(_33);}}else{return dojo.xhrGet({handleAs:(_35)?"json":"text",url:_33});}},_resolveTemplateArg:function(arg,_36){if(ddt._isTemplate(arg)){if(!_36){var d=new dojo.Deferred();d.callback(arg);return d;}return arg;}return ddt._resolveLazy(arg,_36);},_isTemplate:function(arg){return (typeof arg=="undefined")||(typeof arg=="string"&&(arg.match(/^\s*[<{]/)||arg.indexOf(" ")!=-1));},_resolveContextArg:function(arg,_37){if(arg.constructor==Object){if(!_37){var d=new dojo.Deferred;d.callback(arg);return d;}return arg;}return ddt._resolveLazy(arg,_37,true);},_re:/(?:\{\{\s*(.+?)\s*\}\}|\{%\s*(load\s*)?(.+?)\s*%\})/g,tokenize:function(str){return dojox.string.tokenize(str,ddt._re,ddt._parseDelims);},_parseDelims:function(_38,_39,tag){if(_38){return [dd.TOKEN_VAR,_38];}else{if(_39){var _3a=dojo.trim(tag).split(/\s+/g);for(var i=0,_3b;_3b=_3a[i];i++){dojo["require"](_3b);}}else{return [dd.TOKEN_BLOCK,tag];}}}};dd.Template=dojo.extend(function(_3c,_3d){var str=_3d?_3c:ddt._resolveTemplateArg(_3c,true)||"";var _3e=ddt.tokenize(str);var _3f=new dd._Parser(_3e);this.nodelist=_3f.parse();},{update:function(_40,_41){return ddt._resolveContextArg(_41).addCallback(this,function(_42){var _43=this.render(new dd._Context(_42));if(_40.forEach){_40.forEach(function(_44){_44.innerHTML=_43;});}else{dojo.byId(_40).innerHTML=_43;}return this;});},render:function(_45,_46){_46=_46||this.getBuffer();_45=_45||new dd._Context({});return this.nodelist.render(_45,_46)+"";},getBuffer:function(){return new dojox.string.Builder();}});var _47=/\{\{\s*(.+?)\s*\}\}/g;dd.quickFilter=function(str){if(!str){return new dd._NodeList();}if(str.indexOf("{%")==-1){return new dd._QuickNodeList(dojox.string.tokenize(str,_47,function(_48){return new dd._Filter(_48);}));}};dd._QuickNodeList=dojo.extend(function(_49){this.contents=_49;},{render:function(_4a,_4b){for(var i=0,l=this.contents.length;i<l;i++){if(this.contents[i].resolve){_4b=_4b.concat(this.contents[i].resolve(_4a));}else{_4b=_4b.concat(this.contents[i]);}}return _4b;},dummyRender:function(_4c){return this.render(_4c,dd.Template.prototype.getBuffer()).toString();},clone:function(_4d){return this;}});dd._Filter=dojo.extend(function(_4e){if(!_4e){throw new Error("Filter must be called with variable name");}this.contents=_4e;var _4f=this._cache[_4e];if(_4f){this.key=_4f[0];this.filters=_4f[1];}else{this.filters=[];dojox.string.tokenize(_4e,this._re,this._tokenize,this);this._cache[_4e]=[this.key,this.filters];}},{_cache:{},_re:/(?:^_\("([^\\"]*(?:\\.[^\\"])*)"\)|^"([^\\"]*(?:\\.[^\\"]*)*)"|^([a-zA-Z0-9_.]+)|\|(\w+)(?::(?:_\("([^\\"]*(?:\\.[^\\"])*)"\)|"([^\\"]*(?:\\.[^\\"]*)*)"|([a-zA-Z0-9_.]+)|'([^\\']*(?:\\.[^\\']*)*)'))?|^'([^\\']*(?:\\.[^\\']*)*)')/g,_values:{0:"\"",1:"\"",2:"",8:"\""},_args:{4:"\"",5:"\"",6:"",7:"'"},_tokenize:function(){var pos,arg;for(var i=0,has=[];i<arguments.length;i++){has[i]=(typeof arguments[i]!="undefined"&&typeof arguments[i]=="string"&&arguments[i]);}if(!this.key){for(pos in this._values){if(has[pos]){this.key=this._values[pos]+arguments[pos]+this._values[pos];break;}}}else{for(pos in this._args){if(has[pos]){var _50=arguments[pos];if(this._args[pos]=="'"){_50=_50.replace(/\\'/g,"'");}else{if(this._args[pos]=="\""){_50=_50.replace(/\\"/g,"\"");}}arg=[!this._args[pos],_50];break;}}var fn=ddt.getFilter(arguments[3]);if(!dojo.isFunction(fn)){throw new Error(arguments[3]+" is not registered as a filter");}this.filters.push([fn,arg]);}},getExpression:function(){return this.contents;},resolve:function(_51){if(typeof this.key=="undefined"){return "";}var str=this.resolvePath(this.key,_51);for(var i=0,_52;_52=this.filters[i];i++){if(_52[1]){if(_52[1][0]){str=_52[0](str,this.resolvePath(_52[1][1],_51));}else{str=_52[0](str,_52[1][1]);}}else{str=_52[0](str);}}return str;},resolvePath:function(_53,_54){var _55,_56;var _57=_53.charAt(0);var _58=_53.slice(-1);if(!isNaN(parseInt(_57))){_55=(_53.indexOf(".")==-1)?parseInt(_53):parseFloat(_53);}else{if(_57=="\""&&_57==_58){_55=_53.slice(1,-1);}else{if(_53=="true"){return true;}if(_53=="false"){return false;}if(_53=="null"||_53=="None"){return null;}_56=_53.split(".");_55=_54.get(_56[0]);if(dojo.isFunction(_55)){var _59=_54.getThis&&_54.getThis();if(_55.alters_data){_55="";}else{if(_59){_55=_55.call(_59);}else{_55="";}}}for(var i=1;i<_56.length;i++){var _5a=_56[i];if(_55){var _5b=_55;if(dojo.isObject(_55)&&_5a=="items"&&typeof _55[_5a]=="undefined"){var _5c=[];for(var key in _55){_5c.push([key,_55[key]]);}_55=_5c;continue;}if(_55.get&&dojo.isFunction(_55.get)&&_55.get.safe){_55=_55.get(_5a);}else{if(typeof _55[_5a]=="undefined"){_55=_55[_5a];break;}else{_55=_55[_5a];}}if(dojo.isFunction(_55)){if(_55.alters_data){_55="";}else{_55=_55.call(_5b);}}else{if(_55 instanceof Date){_55=dd._Context.prototype._normalize(_55);}}}else{return "";}}}}return _55;}});dd._TextNode=dd._Node=dojo.extend(function(obj){this.contents=obj;},{set:function(_5d){this.contents=_5d;return this;},render:function(_5e,_5f){return _5f.concat(this.contents);},isEmpty:function(){return !dojo.trim(this.contents);},clone:function(){return this;}});dd._NodeList=dojo.extend(function(_60){this.contents=_60||[];this.last="";},{push:function(_61){this.contents.push(_61);return this;},concat:function(_62){this.contents=this.contents.concat(_62);return this;},render:function(_63,_64){for(var i=0;i<this.contents.length;i++){_64=this.contents[i].render(_63,_64);if(!_64){throw new Error("Template must return buffer");}}return _64;},dummyRender:function(_65){return this.render(_65,dd.Template.prototype.getBuffer()).toString();},unrender:function(){return arguments[1];},clone:function(){return this;},rtrim:function(){while(1){i=this.contents.length-1;if(this.contents[i] instanceof dd._TextNode&&this.contents[i].isEmpty()){this.contents.pop();}else{break;}}return this;}});dd._VarNode=dojo.extend(function(str){this.contents=new dd._Filter(str);},{render:function(_66,_67){var str=this.contents.resolve(_66);if(!str.safe){str=dd._base.escape(""+str);}return _67.concat(str);}});dd._noOpNode=new function(){this.render=this.unrender=function(){return arguments[1];};this.clone=function(){return this;};};dd._Parser=dojo.extend(function(_68){this.contents=_68;},{i:0,parse:function(_69){var _6a={},_6b;_69=_69||[];for(var i=0;i<_69.length;i++){_6a[_69[i]]=true;}var _6c=new dd._NodeList();while(this.i<this.contents.length){_6b=this.contents[this.i++];if(typeof _6b=="string"){_6c.push(new dd._TextNode(_6b));}else{var _6d=_6b[0];var _6e=_6b[1];if(_6d==dd.TOKEN_VAR){_6c.push(new dd._VarNode(_6e));}else{if(_6d==dd.TOKEN_BLOCK){if(_6a[_6e]){--this.i;return _6c;}var cmd=_6e.split(/\s+/g);if(cmd.length){cmd=cmd[0];var fn=ddt.getTag(cmd);if(fn){_6c.push(fn(this,new dd.Token(_6d,_6e)));}}}}}}if(_69.length){throw new Error("Could not find closing tag(s): "+_69.toString());}this.contents.length=0;return _6c;},next_token:function(){var _6f=this.contents[this.i++];return new dd.Token(_6f[0],_6f[1]);},delete_first_token:function(){this.i++;},skip_past:function(_70){while(this.i<this.contents.length){var _71=this.contents[this.i++];if(_71[0]==dd.TOKEN_BLOCK&&_71[1]==_70){return;}}throw new Error("Unclosed tag found when looking for "+_70);},create_variable_node:function(_72){return new dd._VarNode(_72);},create_text_node:function(_73){return new dd._TextNode(_73||"");},getTemplate:function(_74){return new dd.Template(_74);}});dd.register={_registry:{attributes:[],tags:[],filters:[]},get:function(_75,_76){var _77=dd.register._registry[_75+"s"];for(var i=0,_78;_78=_77[i];i++){if(typeof _78[0]=="string"){if(_78[0]==_76){return _78;}}else{if(_76.match(_78[0])){return _78;}}}},getAttributeTags:function(){var _79=[];var _7a=dd.register._registry.attributes;for(var i=0,_7b;_7b=_7a[i];i++){if(_7b.length==3){_79.push(_7b);}else{var fn=dojo.getObject(_7b[1]);if(fn&&dojo.isFunction(fn)){_7b.push(fn);_79.push(_7b);}}}return _79;},_any:function(_7c,_7d,_7e){for(var _7f in _7e){for(var i=0,fn;fn=_7e[_7f][i];i++){var key=fn;if(dojo.isArray(fn)){key=fn[0];fn=fn[1];}if(typeof key=="string"){if(key.substr(0,5)=="attr:"){var _80=fn;if(_80.substr(0,5)=="attr:"){_80=_80.slice(5);}dd.register._registry.attributes.push([_80.toLowerCase(),_7d+"."+_7f+"."+_80]);}key=key.toLowerCase();}dd.register._registry[_7c].push([key,fn,_7d+"."+_7f]);}}},tags:function(_81,_82){dd.register._any("tags",_81,_82);},filters:function(_83,_84){dd.register._any("filters",_83,_84);}};var _85=/&/g;var _86=/</g;var _87=/>/g;var _88=/'/g;var _89=/"/g;dd._base.escape=function(_8a){return dd.mark_safe(_8a.replace(_85,"&amp;").replace(_86,"&lt;").replace(_87,"&gt;").replace(_89,"&quot;").replace(_88,"&#39;"));};dd._base.safe=function(_8b){if(typeof _8b=="string"){_8b=new String(_8b);}if(typeof _8b=="object"){_8b.safe=true;}return _8b;};dd.mark_safe=dd._base.safe;dd.register.tags("dojox.dtl.tag",{"date":["now"],"logic":["if","for","ifequal","ifnotequal"],"loader":["extends","block","include","load","ssi"],"misc":["comment","debug","filter","firstof","spaceless","templatetag","widthratio","with"],"loop":["cycle","ifchanged","regroup"]});dd.register.filters("dojox.dtl.filter",{"dates":["date","time","timesince","timeuntil"],"htmlstrings":["linebreaks","linebreaksbr","removetags","striptags"],"integers":["add","get_digit"],"lists":["dictsort","dictsortreversed","first","join","length","length_is","random","slice","unordered_list"],"logic":["default","default_if_none","divisibleby","yesno"],"misc":["filesizeformat","pluralize","phone2numeric","pprint"],"strings":["addslashes","capfirst","center","cut","fix_ampersands","floatformat","iriencode","linenumbers","ljust","lower","make_list","rjust","slugify","stringformat","title","truncatewords","truncatewords_html","upper","urlencode","urlize","urlizetrunc","wordcount","wordwrap"]});dd.register.filters("dojox.dtl",{"_base":["escape","safe"]});})();}if(!dojo._hasResource["dojox.dtl"]){dojo._hasResource["dojox.dtl"]=true;dojo.provide("dojox.dtl");}if(!dojo._hasResource["dojox.dtl.Context"]){dojo._hasResource["dojox.dtl.Context"]=true;dojo.provide("dojox.dtl.Context");dojox.dtl.Context=dojo.extend(function(_8c){this._this={};dojox.dtl._Context.call(this,_8c);},dojox.dtl._Context.prototype,{getKeys:function(){var _8d=[];for(var key in this){if(this.hasOwnProperty(key)&&key!="_this"){_8d.push(key);}}return _8d;},extend:function(obj){return dojo.delegate(this,obj);},filter:function(_8e){var _8f=new dojox.dtl.Context();var _90=[];var i,arg;if(_8e instanceof dojox.dtl.Context){_90=_8e.getKeys();}else{if(typeof _8e=="object"){for(var key in _8e){_90.push(key);}}else{for(i=0;arg=arguments[i];i++){if(typeof arg=="string"){_90.push(arg);}}}}for(i=0,key;key=_90[i];i++){_8f[key]=this[key];}return _8f;},setThis:function(_91){this._this=_91;},getThis:function(){return this._this;},hasKey:function(key){if(this._getter){var got=this._getter(key);if(typeof got!="undefined"){return true;}}if(typeof this[key]!="undefined"){return true;}return false;}});}if(!dojo._hasResource["depot.OrderHistoryController"]){dojo._hasResource["depot.OrderHistoryController"]=true;dojo.provide("depot.OrderHistoryController");dojo.declare("depot.OrderHistoryController",null,{format:null,orderStore:null,template:null,constructor:function(){this.format={id:"orderId",items:[]};this.orderStore=new dojo.data.ItemFileReadStore({data:this.format,clearOnClose:true});dojo.connect(dijit.byId("orderHistory"),"onLoad",this,this.getOrders);dojo.subscribe("orderHistory-select",this,this.getOrders);},getOrders:function(){console.debug("Getting Orders");var _92={url:"/CustomerOrderServicesWeb/jaxrs/Customer/Orders",handleAs:"json",load:dojo.hitch(this,this.loadOrdersSuccess),error:dojo.hitch(this,this.loadOrdersError)};return dojo.xhrGet(_92);},loadOrdersSuccess:function(_93){console.debug("Order History",_93);this.format.items=_93;this.orderStore.data=this.format;this.orderStore.close();console.debug(dijit.byId("orderHistoryGrid"));dijit.byId("orderHistoryGrid").setStore(this.orderStore);},loadOrdersError:function(_94){console.error(_94);},formatStatus:function(_95){console.debug("format status",_95);return (_95&&_95=="OPEN")?"Current Order":_95;},getLineItems:function(i,_96){console.debug("getLineItem,",_96);var li=[];if(_96){dojo.forEach(_96.lineitems,function(_97,i){console.debug(_97,i);li[i]=_97;});}console.debug("li",li);return li;},formatLineItems:function(_98){console.debug("format",_98);if(_98){if(!this.template){this.template=new dojox.dtl.Template(dojo.moduleUrl("orderHistory","orderHistoryTemplate.html"));}var _99=new dojox.dtl.Context({lis:_98});var _9a=this.template.render(_99);return _9a;}}});}if(!dojo._hasResource["dojox.dtl.tag.logic"]){dojo._hasResource["dojox.dtl.tag.logic"]=true;dojo.provide("dojox.dtl.tag.logic");(function(){var dd=dojox.dtl;var ddt=dd.text;var _9b=dd.tag.logic;_9b.IfNode=dojo.extend(function(_9c,_9d,_9e,_9f){this.bools=_9c;this.trues=_9d;this.falses=_9e;this.type=_9f;},{render:function(_a0,_a1){var i,_a2,_a3,_a4,_a5;if(this.type=="or"){for(i=0;_a2=this.bools[i];i++){_a3=_a2[0];_a4=_a2[1];_a5=_a4.resolve(_a0);if((_a5&&!_a3)||(_a3&&!_a5)){if(this.falses){_a1=this.falses.unrender(_a0,_a1);}return (this.trues)?this.trues.render(_a0,_a1,this):_a1;}}if(this.trues){_a1=this.trues.unrender(_a0,_a1);}return (this.falses)?this.falses.render(_a0,_a1,this):_a1;}else{for(i=0;_a2=this.bools[i];i++){_a3=_a2[0];_a4=_a2[1];_a5=_a4.resolve(_a0);if(_a5==_a3){if(this.trues){_a1=this.trues.unrender(_a0,_a1);}return (this.falses)?this.falses.render(_a0,_a1,this):_a1;}}if(this.falses){_a1=this.falses.unrender(_a0,_a1);}return (this.trues)?this.trues.render(_a0,_a1,this):_a1;}return _a1;},unrender:function(_a6,_a7){_a7=(this.trues)?this.trues.unrender(_a6,_a7):_a7;_a7=(this.falses)?this.falses.unrender(_a6,_a7):_a7;return _a7;},clone:function(_a8){var _a9=(this.trues)?this.trues.clone(_a8):null;var _aa=(this.falses)?this.falses.clone(_a8):null;return new this.constructor(this.bools,_a9,_aa,this.type);}});_9b.IfEqualNode=dojo.extend(function(_ab,_ac,_ad,_ae,_af){this.var1=new dd._Filter(_ab);this.var2=new dd._Filter(_ac);this.trues=_ad;this.falses=_ae;this.negate=_af;},{render:function(_b0,_b1){var _b2=this.var1.resolve(_b0);var _b3=this.var2.resolve(_b0);_b2=(typeof _b2!="undefined")?_b2:"";_b3=(typeof _b2!="undefined")?_b3:"";if((this.negate&&_b2!=_b3)||(!this.negate&&_b2==_b3)){if(this.falses){_b1=this.falses.unrender(_b0,_b1,this);}return (this.trues)?this.trues.render(_b0,_b1,this):_b1;}if(this.trues){_b1=this.trues.unrender(_b0,_b1,this);}return (this.falses)?this.falses.render(_b0,_b1,this):_b1;},unrender:function(_b4,_b5){return _9b.IfNode.prototype.unrender.call(this,_b4,_b5);},clone:function(_b6){var _b7=this.trues?this.trues.clone(_b6):null;var _b8=this.falses?this.falses.clone(_b6):null;return new this.constructor(this.var1.getExpression(),this.var2.getExpression(),_b7,_b8,this.negate);}});_9b.ForNode=dojo.extend(function(_b9,_ba,_bb,_bc){this.assign=_b9;this.loop=new dd._Filter(_ba);this.reversed=_bb;this.nodelist=_bc;this.pool=[];},{render:function(_bd,_be){var i,j,k;var _bf=false;var _c0=this.assign;for(k=0;k<_c0.length;k++){if(typeof _bd[_c0[k]]!="undefined"){_bf=true;_bd=_bd.push();break;}}if(!_bf&&_bd.forloop){_bf=true;_bd=_bd.push();}var _c1=this.loop.resolve(_bd)||[];for(i=_c1.length;i<this.pool.length;i++){this.pool[i].unrender(_bd,_be,this);}if(this.reversed){_c1=_c1.slice(0).reverse();}var _c2=dojo.isObject(_c1)&&!dojo.isArrayLike(_c1);var _c3=[];if(_c2){for(var key in _c1){_c3.push(_c1[key]);}}else{_c3=_c1;}var _c4=_bd.forloop={parentloop:_bd.get("forloop",{})};var j=0;for(i=0;i<_c3.length;i++){var _c5=_c3[i];_c4.counter0=j;_c4.counter=j+1;_c4.revcounter0=_c3.length-j-1;_c4.revcounter=_c3.length-j;_c4.first=!j;_c4.last=(j==_c3.length-1);if(_c0.length>1&&dojo.isArrayLike(_c5)){if(!_bf){_bf=true;_bd=_bd.push();}var _c6={};for(k=0;k<_c5.length&&k<_c0.length;k++){_c6[_c0[k]]=_c5[k];}dojo.mixin(_bd,_c6);}else{_bd[_c0[0]]=_c5;}if(j+1>this.pool.length){this.pool.push(this.nodelist.clone(_be));}_be=this.pool[j++].render(_bd,_be,this);}delete _bd.forloop;if(_bf){_bd=_bd.pop();}else{for(k=0;k<_c0.length;k++){delete _bd[_c0[k]];}}return _be;},unrender:function(_c7,_c8){for(var i=0,_c9;_c9=this.pool[i];i++){_c8=_c9.unrender(_c7,_c8);}return _c8;},clone:function(_ca){return new this.constructor(this.assign,this.loop.getExpression(),this.reversed,this.nodelist.clone(_ca));}});dojo.mixin(_9b,{if_:function(_cb,_cc){var i,_cd,_ce,_cf=[],_d0=_cc.contents.split();_d0.shift();_cc=_d0.join(" ");_d0=_cc.split(" and ");if(_d0.length==1){_ce="or";_d0=_cc.split(" or ");}else{_ce="and";for(i=0;i<_d0.length;i++){if(_d0[i].indexOf(" or ")!=-1){throw new Error("'if' tags can't mix 'and' and 'or'");}}}for(i=0;_cd=_d0[i];i++){var not=false;if(_cd.indexOf("not ")==0){_cd=_cd.slice(4);not=true;}_cf.push([not,new dd._Filter(_cd)]);}var _d1=_cb.parse(["else","endif"]);var _d2=false;var _cc=_cb.next_token();if(_cc.contents=="else"){_d2=_cb.parse(["endif"]);_cb.next_token();}return new _9b.IfNode(_cf,_d1,_d2,_ce);},_ifequal:function(_d3,_d4,_d5){var _d6=_d4.split_contents();if(_d6.length!=3){throw new Error(_d6[0]+" takes two arguments");}var end="end"+_d6[0];var _d7=_d3.parse(["else",end]);var _d8=false;var _d4=_d3.next_token();if(_d4.contents=="else"){_d8=_d3.parse([end]);_d3.next_token();}return new _9b.IfEqualNode(_d6[1],_d6[2],_d7,_d8,_d5);},ifequal:function(_d9,_da){return _9b._ifequal(_d9,_da);},ifnotequal:function(_db,_dc){return _9b._ifequal(_db,_dc,true);},for_:function(_dd,_de){var _df=_de.contents.split();if(_df.length<4){throw new Error("'for' statements should have at least four words: "+_de.contents);}var _e0=_df[_df.length-1]=="reversed";var _e1=(_e0)?-3:-2;if(_df[_df.length+_e1]!="in"){throw new Error("'for' tag received an invalid argument: "+_de.contents);}var _e2=_df.slice(1,_e1).join(" ").split(/ *, */);for(var i=0;i<_e2.length;i++){if(!_e2[i]||_e2[i].indexOf(" ")!=-1){throw new Error("'for' tag received an invalid argument: "+_de.contents);}}var _e3=_dd.parse(["endfor"]);_dd.next_token();return new _9b.ForNode(_e2,_df[_df.length+_e1+1],_e0,_e3);}});})();}
